/**
 * Page Router.
 *
 * @author Jared Allard <jaredallard@outlook.com>
 * @version 1.0.0
 * @license MIT
 **/
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),Route=function(){function e(t,o){_classCallCheck(this,e),console.log("constructed a new route"),t&&(this._path=t),o&&(this._code=o)}return _createClass(e,[{key:"use",value:function(e){this._code=e}},{key:"path",value:function(e){this._path=e}}]),e}(),Router=function(){function e(){_classCallCheck(this,e),console.log("constructed router."),this.active=!1,this.routes=[],this.binds=[]}return _createClass(e,[{key:"hook",value:function(){var e=this;this.active=!0,console.log("router hooked into page.");var t=function(){console.log("router: started pace"),Pace.start();var t=document.location.hash.replace(/^#/,"");console.log("router: page ->",t),$("#dom").css("background","#FFFFFF"),"/login"!==t?$("#bg-stars").hide():$("#bg-stars").show();var o=0;e.routes.forEach(function(e){e.path===t&&(console.log("router: page hit on index:",o),console.log("router: route ->",e),-e.code(),o++)}),$(document).ready(function(){console.log("router: finished loading anything"),console.log("router: executing bind(s)"),e.binds.forEach(function(e){e.code()}),Pace.stop()})};window.onhashchange=t,t()}},{key:"isActive",value:function(){return this.active}},{key:"use",value:function(e){return!(!e._path||!e._code)&&(this.routes.push({path:e._path,code:e._code,object:e}),void console.log("registered route",e._path,"onto Router"))}},{key:"bind",value:function(e){this.binds.push({code:e}),console.log("router: new bind added, total:",this.binds.length)}}]),e}(),triton=new Triton($),router=new Router,login=new Route("/login");login.use(function(){$("#dom").css("background","url('/css/img/bg-main.png')"),$("#dom").html(TRITON.templates.login())});var index=new Route("/");index.use(function(){$("#dom").html(TRITON.templates.index())});var dash=new Route("/dashboard");dash.use(function(){triton.get("users").then(function(e){var t="http://www.gravatar.com/avatar/"+md5(e.email),o=e.display_name;triton.get("assignments/list").then(function(e){$("#dom").html(TRITON.templates.dashboard({header:TRITON.templates.dash_header({image:t,info:o}),assignments:e,footer:TRITON.templates.dash_footer()}))})})});var sett=new Route("/dashboard/settings");sett.use(function(){triton.get("users").then(function(e){var t="http://www.gravatar.com/avatar/"+md5(e.email),o=e.display_name;$("#dom").html(TRITON.templates.settings({header:TRITON.templates.dash_header({image:t,info:o}),footer:TRITON.templates.dash_footer(),display_name:e.display_name,email:e.email}))})});var logout=new Route("/dashboard/logout");logout.use(function(){triton.invalidateCache("assignments/list"),$.cookie("triton_userapikey",void 0),window.location="/",console.log("logged out user")}),router.use(index),router.use(login),router.use(dash),router.use(sett),router.use(logout),window.ROUTER=router,router.hook();