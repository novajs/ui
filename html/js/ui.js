"use strict";function updateUserInfo(a,o,e){var i=o.val(),t=a.val(),r=e.val();if(!i)return o.parent().addClass("has-error");var n=[{type:"email",val:t},{type:"display_name",val:r}],l={};n.forEach(function(a){return""===a.val||"undefined"==typeof a.val||null===a.val||" "===a.val?void console.log("invalid value for opt type:",a.type):void(l[a.type]=a.val)}),triton.post("users/update",l).then(function(a){triton.invalidate("users")})["catch"](function(a){console.log(a)})}var triton=new Triton($),gravatar=function(a,o){var e,o=o||{},i=[];return o={size:o.size||"50",rating:o.rating||"g",secure:o.secure||"https:"===location.protocol,backup:o.backup||""},a=a.trim().toLowerCase(),e=o.secure?"https://secure.gravatar.com/avatar/":"http://www.gravatar.com/avatar/",o.rating&&i.push("r="+o.rating),o.backup&&i.push("d="+encodeURIComponent(o.backup)),o.size&&i.push("s="+o.size),e+md5(a)+"?"+i.join("&")},main=function(){var a=$.cookie("triton_useremail");if(a){$("#login-email").val(a);var o=gravatar(a,{size:"100",backup:$("#login-image").attr("src")});$("#login-image").attr("src",o),$("#login-image").attr("data-md5",md5(a))}$("#login-email").on("focusout",function(){var a=$("#login-email").val();if(md5(a)===$("#login-image").attr("data-md5"))return void console.log("MD5 is same, ignore.");if(""!==a&&null!=a&&" "!==a){var o=gravatar(a,{size:"100",backup:$("#login-image").attr("src")});console.log("email",a),console.log("gravatar",o),$("#login-image").attr("src",o),$("#login-image").attr("data-md5",md5(a))}}),$("#login-submit").on("click",function(){console.log("BEGIN LAUNCH SEQUENCES");var a=$("#login-email").val();if(a&&" "!==a&&""!==a){console.log("set triton_useremail cookie"),$.cookie("triton_useremail",a);var o=$("#login-email").val(),e=$("#login-password").val();console.log("POST:",o,"<pass>"),$.ajax({type:"POST",headers:{"Content-Type":"application/json"},url:"http://127.0.0.1:8000/v1/users/authflow",data:JSON.stringify({email:o,password:e}),success:function(a){if(!a)return console.error("Invalid Response from Server",a);if(!a.success)return console.error("Recieved success=false",a);var o=a.data["public"]+":"+a.data.secret;$.cookie("triton_userapikey",o),window.location.hash="/dashboard",console.log("BUILT:",o)}})}}),$.material.init()};router&&(console.log("ui is binding to router."),window.ROUTER.bind(main));