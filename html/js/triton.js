/**
 * API Library for TritonJS.
 *
 * @author Jared Allard <jaredallard@outlook.com>
 * @version 1.0.0
 * @license MIT
 **/
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),Triton=function(){function e(t){_classCallCheck(this,e),"object"===_typeof(window.API_CONFIG)&&(this.url=window.API_CONFIG.host.replace(/\/$/g,"")+"/v"+window.API_CONFIG.version,console.log("TRITON: #API_CONFIG ->",this.url)),this.url="http://api.tritonjs.com/v1",this.$=t||$,console.log("Triton API initialized.")}return _createClass(e,[{key:"request",value:function(e,t,o){var n=this;o||(o={});var r=this.url+"/"+t;return new Promise(function(a,c){console.log("TRITON:",e.toUpperCase(),r);var i={url:r,method:e,headers:{Authentication:$.cookie("triton_userapikey")},cache:!1,success:function(e){return e.success?(e=e.data,n.setCache(t,e),a(e)):console.error("API Reported Error",e)},failure:function(e,t,o){return console.error(n.url,t,o.toString()),c(o)}};"get"!==e&&(console.log("triton: modifying reqopts to use JSON as data."),i.data=o,i.dataType="json"),n.$.ajax(i)})}},{key:"post",value:function(e,t){}},{key:"get",value:function(e,t){return this.isCached(e)?this.getCache(e):this.request("get",e,t)}},{key:"setCache",value:function(e,t){console.log("TRITON: CACHED ->",e);var o=JSON.stringify(t);localStorage.setItem("cached_endpoint_"+encodeURIComponent(e),o)}},{key:"getCache",value:function(e){return console.log("TRITON: USE CACHE ->",e),new Promise(function(t,o){var n=localStorage.getItem("cached_endpoint_"+encodeURIComponent(e)),r=JSON.parse(n);return t(r)})}},{key:"invalidateCache",value:function(e){localStorage.removeItem("cached_endpoint_"+encodeURIComponent(e))}},{key:"isCached",value:function(e){return!!localStorage.getItem("cached_endpoint_"+encodeURIComponent(e))}}]),e}();